<!-- views/admin/client-details.ejs -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Detalhes do Cliente</title>
  </head>
<body>

<div class="main">
    <div class="main-content client project">
        <div class="row">

            <!-- Status Cards -->
            <div class="col-12 d-flex gap-3 flex-wrap">
                <div class="icon-box bg-color-6 d-block text-center color-6">
                    <h5>Total Projects</h5>
                    <span class="number"><%= countByStatus.total %></span>
                </div>
                <div class="icon-box bg-color-9 d-block text-center color-9">
                    <h5>Pending</h5>
                    <span class="number"><%= countByStatus.pending %></span>
                </div>
                <div class="icon-box bg-color-7 d-block text-center color-7">
                    <h5>On Going</h5>
                    <span class="number"><%= countByStatus.ongoing %></span>
                </div>
                <div class="icon-box bg-color-8 d-block text-center color-8">
                    <h5>Completed</h5>
                    <span class="number"><%= countByStatus.completed %></span>
                </div>
            </div>

            <!-- Client Info + Tabs -->
            <div class="col-12 mt-4">
                <div class="box user-pro-list overflow-hidden mb-30 text-center">
                    <div class="box-body">
                        <% if (client.image) { %>
                            <img class="rounded-circle" src="/public/images/client/<%= client.image %>" width="100" height="100" alt="Client Logo">
                        <% } else { %>
                            <div class="rounded-circle bg-secondary text-white p-4">No Logo</div>
                        <% } %>
                        <h2 class="mt-3"><%= client.name %></h2>
                        <span class="badge <%= client.status === 'Active' ? 'badge-success' : 'badge-danger' %>"><%= client.status %></span>
                    </div>
                </div>

                <!-- Tabs: Overview / Projects -->
                <div class="box">
                    <ul class="nav nav-tabs">
                        <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#overview">Overview</a></li>
                        <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#projects">Projects</a></li>
                    </ul>
                    <div class="tab-content p-3">

                        <!-- Overview -->
                        <div class="tab-pane fade show active" id="overview">
                            <h5>About</h5>
                            <p><%= client.about || 'No description provided.' %></p>

                            <table class="table">
                                <tbody>
                                <tr><td>Email:</td><td><%= client.email_id %></td></tr>
                                <tr><td>Contact:</td><td><%= client.contact_no %></td></tr>
                                <tr><td>Country:</td><td><%= client.country %></td></tr>
                                <tr><td>Address:</td><td><%= client.address %></td></tr>
                                <tr><td>Website:</td><td><%= client.website %></td></tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- Projects -->
                        <div class="tab-pane fade" id="projects">
                            <% if (projects.length === 0) { %>
                                <p>No projects found for this client.</p>
                            <% } else { %>
                                <div class="table-responsive">
                                    <table class="table table-bordered">
                                        <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>Project</th>
                                            <th>Start</th>
                                            <th>Deadline</th>
                                            <th>Status</th>
                                            <th>Action</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <% projects.forEach(p => { %>
                                            <tr>
                                                <td><%= p.project_id %></td>
                                                <td><a href="/admin/project/details?data=<%= p.id %>"><%= p.project_title %></a></td>
                                                <td><%= p.start_date %></td>
                                                <td><%= p.end_date %></td>
                                                <td>
                                                    <span class="badge <%= 
                                                        p.work_status === 'Pending' ? 'badge-danger' : 
                                                        p.work_status === 'On Progress' ? 'badge-warning' : 
                                                        'badge-success' 
                                                    %>"><%= p.work_status %></span>
                                                </td>
                                                <td>
                                                    <a href="/admin/project/delete?data=<%= p.project_id %>" class="btn btn-danger btn-sm">Delete</a>
                                                </td>
                                            </tr>
                                        <% }) %>
                                        </tbody>
                                    </table>
                                </div>
                            <% } %>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

<div class="overlay"></div>
<!-- JS GLOBAL -->
<script src="/libs/jquery/jquery.min.js"></script>
<script src="/libs/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="/libs/simplebar/simplebar.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/script.js"></script>
</body>
</html>
